<!-- CUSTOMER APP MONITOR SERVICE FORM -->
<div id="updateAppMonitorService" class="modal fade bd-example-modal-lg" data-keyboard="false" data-backdrop="static" style="top: 0px;" role="dialog" ng-init="getDestinationLicenceListFn();">
  	<div class="modal-dialog modal-lg" >
	    <div class="modal-content">
          	<div class="modal-header">
          		<button type="button" class="close" ng-click="modalConfirmation('closeServiceWindow', 0, service.update)"><span aria-hidden="true"><i alt="Cerrar" class="glyphicon glyphicon-remove-sign"> </i></span><span class="sr-only">Close</span></button>
            	<h3 class="modal-title"><i class="product-success fas fa-wrench"></i> MODIFICAR SERVICIO APP MONITOR</h3>
        	</div>
    		<div class="modal-body"  style="overflow-y: scroll;">
				<!-- FORM CONTAINER-->
				<form class="form-horizontal" name="fCustomerUpdateService" novalidate>
					<fieldset>
						<!-- APP_MONITOR: nombre -->
						<div class="form-group n-padding-l n-padding-r col-md-12" ng-class="
								{	'has-success': 
									service.update.name!='' && fCustomerUpdateService.service_name.$valid,
								 	'has-error':  
									(service.update.name=='' || service.update.name==undefined) && fCustomerUpdateService.service_name.$touched,
								}">
						  <label style="padding-left: 15px;">Nombre</label><br>
							  <div class="col-md-6 col-xs-12">
								<div class="input-group">
									<span class="input-group-addon"><i class="fas fa-tag"></i></span>
									<input name="service_name" id="service_name" type="text" class="form-control" ng-model="service.update.name" required="true" />
							  </div>
							</div>
						</div>					
						<!-- APP_MONITOR: contrato -->
						<div class="form-group col-md-6 n-padding-l n-padding-r" ng-class="
									{	'has-success': 
										service.update.idContratoFk!='' && fCustomerUpdateService.service_contract.$valid,
									 	'has-error':  
										(service.update.idContratoFk=='' || service.update.idContratoFk==undefined) && fCustomerUpdateService.service_contract.$touched,
									}">
						  <label style="padding-left: 15px;">Contrato asociado</label>  
							  <div class="col-xs-12">
								<div class="input-group">
									<span class="input-group-addon"><i class="fas fa-file-contract"></i></span>
									<select name="service_contract" 
									class="form-control" 
									ng-options="item.idContrato as item.numeroContrato for item in rsCustomerContractListData" ng-model="service.update.idContratoFk"
									ng-change="switchContractService(service.update)" required="true" ng-disabled="true" autofocus >
									    <option class="text-uppercase" value="">Selecciona un contrato</option>
								    </select>
							  </div>
							</div>
						</div>
						<!-- APP_MONITOR: Maintenance Type -->					  
						<div class="form-group col-md-6 n-padding-l n-padding-r" >  
						  	<label style="padding-left: 15px;">Tipo de mantenimiento</label>
						    <div class="col-xs-12 ">
							    <div class="input-group">
							    	<span class="input-group-addon"><i class="far fa-calendar-alt"></i></span>
					    			<input name="service_mnt_type" type="text" class="form-control" ng-disabled="true" ng-model="service.update.MntType" />
					    		</div>
					    	</div>
						</div>					
						<!-- APP_MONITOR: Start_date -->
						<div class="form-group col-md-6 n-padding-l n-padding-r" ng-class="
									{	'has-success': 
										service.update.dateUp!='' && fCustomerUpdateService.service_start_date.$valid,
									 	'has-error':  
										(service.update.dateUp=='' || service.update.dateUp==undefined) && fCustomerUpdateService.service_start_date.$touched,
									}">
						  <label style="padding-left: 15px;">Fecha de alta</label>  
							  <div class="col-xs-12">
								<div class="input-group">
									<span class="input-group-addon"><i class="far fa-calendar-alt"></i></span>
									<input name="service_start_date" type="text" ng-keydown="fnLoadPhoneMask()" required="true" ng-disabled="true" class="form-control input--date" ng-model="service.update.dateUp" />
							  </div>
							</div>
						</div>
						<!-- APP_MONITOR: End_date -->
						<div class="form-group col-md-6 n-padding-l n-padding-r">
						  <label style="padding-left: 15px;">Fecha de baja</label>  
							  <div class="col-xs-12">
								<div class="input-group">
									<span class="input-group-addon"><i class="far fa-calendar-alt"></i></span>
									<input name="service_end_date" type="text" ng-keydown="fnLoadPhoneMask()" class="form-control input--date" ng-model="service.update.dateDown" />
							  </div>
							</div>
						</div>
						<!-- APP_MONITOR: empresa monitoreo -->
						<div class="form-group col-md-6 n-padding-l n-padding-r" ng-class="
									{	'has-success': 
										service.update.idCompanyMonitorFK!='' && fCustomerUpdateService.service_monitorCompany.$valid,
									 	'has-error':  
										(service.update.idCompanyMonitorFK=='' || service.update.idCompanyMonitorFK==undefined) && fCustomerUpdateService.service_monitorCompany.$touched,
									}">
						  <label style="padding-left: 15px;">Empresa de monitoreo</label>  
							  <div class="col-xs-12">
								<div class="input-group">
									<span class="input-group-addon"><i class="fas fa-broadcast-tower"></i></span>
									<select name="service_monitorCompany" 
									class="form-control" 
									ng-options="item.idMonitorCompany as item.monitorCompany for item in rsMonitorCompanyListData" ng-model="service.update.idCompanyMonitorFK"
									required="true" autofocus >
									    <option class="text-uppercase" value="">Selecciona una empresa</option>
								    </select>
							  </div>
							</div>
						</div>							
						<!-- APP_MONITOR: N° Abonado -->
						<div class="form-group col-md-6 n-padding-l n-padding-r" ng-class="
								{	'has-success': 
									service.update.sucribeNumber!='' && fCustomerUpdateService.service_numberCustomer.$valid,
								 	'has-error':  
									(service.update.sucribeNumber=='' || service.update.sucribeNumber==undefined) && fCustomerUpdateService.service_numberCustomer.$touched,
								}">
						  <label style="padding-left: 15px;">N° de Abonado</label><br>
							  <div class="col-xs-12">
								<div class="input-group">
									<span class="input-group-addon"><i class="fas fa-user-tie"></i></span>
									<input name="service_numberCustomer" type="text" class="form-control" ng-model="service.update.sucribeNumber" required="true" />
							  </div>
							</div>
						</div>
			            <div ng-if="service.update.idClientTypeFk=='2'" class="form-group col-md-12 col-xs-12">
			            	<div class="col-md-12 col-xs-5"><label class="clf-size clf-p-left">Destino de la Licencia</label></div>
			            	<div ng-repeat="item in rsDestinationLicenceListData" ng-class="{
			            									'col-md-4 col-xs-4': item.idDetinationOfLicense=='1',
			            									'col-md-3 col-xs-3': item.idDetinationOfLicense=='2',
			            									'col-md-5 col-xs-5': item.idDetinationOfLicense=='3'
			            									}">
			                	<input id="destinoLicencia{{$index}}" class="radio-2x" type="radio" name="destinoLicencia" value="{{item.idDetinationOfLicense}}" ng-model="service.update.idDetinationOfLicenseFk" required autofocus>
			                    <label for="destinoLicencia{{$index}}" class="radio-2x-label">
			                      <span>{{item.detinationOfLicense}}</span>
			                    </label>
			                </div>			                
			            </div>
			            <div ng-if="service.update.idClientTypeFk=='5'" class="form-group col-md-12 col-xs-12" ng-class="
								{	'has-success': 
									service.update.idParticularAddressFk!='' && fCustomerUpdateService.addressParticular.$valid,
								 	'has-error':  
									(service.update.idParticularAddressFk=='' || service.update.idParticularAddressFk==undefined) && fCustomerUpdateService.addressParticular.$touched,
								}">
			            	<div class="col-md-12 col-xs-5"><label class="clf-size clf-p-left">Direccion del particular</label></div>
			            	<div ng-repeat="item in service.update.list_address_particular" class="col-md-4 col-xs-12">
			                	<input id="addressParticular{{$index}}" class="radio-2x" type="radio" name="addressParticular" value="{{item.idAddressParticular}}" ng-model="service.update.idParticularAddressFk" required autofocus>
			                    <label data-toggle="tooltip" data-placement="top" title="{{item.clarification}}" class="radio-2x-label">
              						<label for="addressParticular{{$index}}" style="cursor: pointer;font-size: 100%;padding-top: 8px;">{{item.address | uppercase}}</label>
              						<i ng-if="item.idTipoInmuebleFk==1" class="fas fa-building" data-toggle="tooltip" data-placement="bottom" title="Departamento">&nbsp;</i>
              						<i ng-if="item.idTipoInmuebleFk==2" class="fas fa-home" data-toggle="tooltip" data-placement="bottom" title="Casa">&nbsp;</i>
              						<i ng-if="item.idTipoInmuebleFk==3" class="fas fa-store-alt" data-toggle="tooltip" data-placement="bottom" title="Local">&nbsp;</i>
			                    </label>
			                </div>			                
			            </div>			            
						<!-- Deparments for customer compnay & Particular -->									
						<div ng-if="service.update.idClientTypeFk=='2'" class="form-group col-md-12 n-padding-l n-padding-r" ng-class="
													  			{	'has-success': 
													  				service.update.idDepartmentFk!='' &&
													  				service.update.idDepartmentFk!=undefined &&
													  				 fCustomerUpdateService.deparment_registered.$valid,
													  			 	'has-error':  
													  				(service.update.idDepartmentFk=='' || service.update.idDepartmentFk==undefined) && fCustomerUpdateService.deparment_registered.$touched,
													  			}">
						  	<label style="padding-left: 25px;">Departamento</label>  
						    <div class="col-xs-12 selectContainer">
							    <div class="input-group">
							    	<span class="input-group-addon"><i class="glyphicon glyphicon-home"></i></span>
							  		<select name="deparment_registered" 
							  				class="form-control" 
							  				ng-options="item.idDepto as item.Depto for item in rsBuildingDepartmentsData" 
							  				ng-required="true"
							  				ng-model="service.update.idDepartmentFk" autofocus >
									    <option value="">Selecciona un departamento</option>
								    </select>
							    </div>
						  </div>
						</div>
						<div class="form-group col-md-12">
							<div class="input-group col-md-4">
								<button  ng-click="isCollapsed = !isCollapsed;" class="btn btn-sm btn-warning"><i class="fas fa-plus"></i> Licencias</button>
							</div>
						</div>						
						<!-- Numero de puerto de camara -->						  
						<div ng-show="!isCollapsed"  class="form-group col-md-4 col-xs-12" >
						  	<label style="padding-left: 15px; margin-top: 5px;">Cantidad de nuevas licencias:</label>
						</div>
						<div ng-show="!isCollapsed" class="form-group col-md-3  col-xs-6 n-padding-r n-padding-l" ng-class="
									{	'has-success': 
										service.numbOfNewLicence!='' && fCustomerUpdateService.service_numbOfLicences.$valid,
									 	'has-error':  
										(service.numbOfNewLicence=='' || service.numbOfNewLicence==undefined) && fCustomerUpdateService.service_numbOfLicences.$touched,
									}">
							<div class="col-xs-12">
							    <div class="input-group">
							    	<span class="input-group-addon"><i class="fas fa-sort-numeric-up-alt"></i></span>
									<input name="service_numbOfLicences" class="form-control" type="number" min="0" max="99" ng-min="0" ng-max="99"   ng-model="service.numbOfNewLicence" required autofocus>				    			
					    		</div>
					    	</div>						
						</div>
						<div ng-show="!isCollapsed" class="form-group col-md-4  col-xs-6">
							<div class="input-group">
								<button ng-disabled="service.numbOfNewLicence<=0"  ng-click="isCollapsed = !isCollapsed; setNewLicencesFn(service.numbOfNewLicence);" class="btn btn-sm btn-success"><i class="fas fa-save"></i> Guardar</button>
							</div>
						</div>
						<div class="form-group col-md-12">
							<div class="col-md-3">
								<button ng-if="service.numbOfNewLicence>=1 && isCollapsed" ng-disabled="service.numbOfLicenceRemains<=0" ng-click="loadServiceLicenceWindowFn()" class="btn btn-sm btn-success"><i class="fas fa-bullseye"></i> Asignar Licencia</button>
							</div>
							<div class="col-md-3">
								<span ng-if="service.numbOfLicenceSet>0 && isCollapsed">
									<label class="label label-default">Pedidas :&nbsp;</label>&nbsp;
									<label class="label" ng-class="{
									'label-success':	service.numbOfLicenceSet>0,
									'label-warning':	service.numbOfLicenceRemains==0 }">{{service.numbOfLicenceSet}}</label>
								</span>
							</div>
							<div class="col-md-3">
								<span ng-if="service.numbOfLicenceSet>0 && isCollapsed">
									<label class="label label-default">Disponibles:&nbsp;</label>&nbsp;
									<label class="label" ng-class="{
									'label-success':	service.numbOfLicenceRemains>1,
									'label-warning':	service.numbOfLicenceRemains==1,
									'label-danger':		service.numbOfLicenceRemains==0 }">{{service.numbOfLicenceRemains}}</label>
								</span>
							</div>							
							<div class="col-md-3">
								<span ng-if="service.numbOfLicenceSet>0 && isCollapsed">
									<label class="label label-default">Asignadas:&nbsp;</label>&nbsp;
									<label class="label" ng-class="{
									'label-success':	list_user_licence.length>0,
									'label-warning':	list_user_licence.length==0}">{{list_user_licence.length}}</label>
								</span>
							</div>
						</div>
						<div class="form-group col-md-12">
							<!-- Licence Assigned List -->
							<div class="well-checkbox n-padding-t n-padding-b" style="margin-left: 0px;margin-right: 0px;">
							  	<table ng-if="list_user_licence.length>0">
							    	<tr ng-repeat="licence in list_user_licence">
							      		<!--<td style="width: 0%; padding: 0 10px 0 10px;"><label style="font-size: 100%" class="label label-default">{{$index+1}}</label></td>-->
							      		<td style="width: 35%">
							      			<span class="text-muted text-box">
							      				{{licence.fullName | uppercase}}&nbsp;
							      				<span data-toggle="tooltip" data-placement="top" title="Usuario del sistema" ng-if="licence.idUserFk" class="btn btn-xs btn-warning"><i class="fas fa-users-cog"></i></span>
							      			</span>
							      		</td>
							      		<td style="width: 30%"><span data-toggle="tooltip" data-placement="top" title="Correo" class="text-muted text-box"><label style="font-size: 100%" class="label label-default"><i class="fas fa-envelope"></i></label>&nbsp;{{licence.email}}</span></td>
							      		<td style="width: 5%"><span class="text-muted text-box"><label style="font-size: 100%" class="label label-default">
							      			<span ng-if="licence.idOS=='1'" data-toggle="tooltip" data-placement="top" title="IOS"><i class="fab fa-apple"></i></span>
							      			<span ng-if="licence.idOS=='2'" data-toggle="tooltip" data-placement="top" title="Android"><i class="fab fa-android"></i></span>
							      		</label></span></td>
							      		<td style="width: 20%"><span data-toggle="tooltip" data-placement="top" title="Perfil" class="text-muted text-box"><label style="font-size: 100%" class="label label-default"><i class="fas fa-address-card"></i></label>&nbsp;{{licence.profileUser}}</span></td>
							          	<td style="width: 10%; padding-bottom: 5px;">
							          		<button data-toggle="tooltip" data-placement="top" title="ver" ng-click="loadSelectedUserLicenceFn(licence);" class="btn btn-xs btn-warning"><i class="far fa-edit"></i></button>
							            	<button data-toggle="tooltip" data-placement="top" title="Remover" ng-click="removeUserLicenceFn(licence);" class="btn btn-xs btn-danger"><i class="far fa-times-circle"></i></button>

							          	</td>
							      	</tr>
							  	</table>
							  	<div ng-if="list_user_licence.length==0" class="text-uppercase banner-no-rows banner-no-rows-padding-1 banner-no-rows-warning"><h5><i class="fas fa-exclamation-triangle"> </i> No hay usuarios cargados</h5></div>
							</div>
						</div>
						<!-- Observaciones Generales -->
						<div class="form-group col-md-12">
						  <label class="col-xs-12" >Observaciones Generales</label> 
								<textarea style="resize: none;" name="ObserGenerales" rows="3" placeholder="indique las Observaciones." class="form-control" ng-model="service.update.observation" ></textarea>							
						</div>																									
					</fieldset>
				</form>
				<div class="clearfix"> </div> 
			</div>
			<!-- Actions Button -->
            <div class="modal-footer">
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-6 pull-right">
                        <button type="submit" ng-click="modalConfirmation('updateService', 0, service.update)" ng-disabled="fCustomerUpdateService.$invalid || list_user_licence.length<=0" class="btn btn-labeled btn-success">
                            <span class="btn-label"><i class="glyphicon glyphicon-send"></i> </span>Enviar</button>
                        <a ng-click="modalConfirmation('closeServiceWindow', 0, service.update)" type="button" class="btn btn-labeled btn-danger">
                            <span class="btn-label"><i class="glyphicon glyphicon-remove"></i></span>Cancelar</a>
                    </div>
                </div>
            </div>
		</div>
	</div>
</div>
<!-- //CUSTOMER APP MONITOR SERVICE FORM -->